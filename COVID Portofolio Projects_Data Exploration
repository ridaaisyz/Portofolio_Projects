SELECT *
FROM PortofolioCovidProject..coviddeaths
WHERE continent IS NOT NULL
ORDER BY location, date

--Select the data that we are going to using
SELECT location, date,total_cases, new_cases, total_deaths, population
FROM PortofolioCovidProject..coviddeaths
WHERE continent IS NOT NULL
ORDER BY location, date ASC

--Total cases vs Total deaths in Indonesia
ALTER TABLE PortofolioCovidproject..coviddeaths
ALTER COLUMN total_cases INT

Select Location, date, total_cases,total_deaths, (total_deaths/total_cases)*100 as Death_Percentage
From PortofolioCovidProject..coviddeaths
WHERE  location = 'Indonesia'
ORDER BY location, date

--Total cases vs Population
Select Location, date, population, total_cases, (total_cases/population)*100 as PopulationInfected_Percentage
From PortofolioCovidProject..coviddeaths
--WHERE  location = 'Indonesia'
ORDER BY location, date;

--Countries with the highest Infection Rate compared to Population
Select Location, population, MAX(total_cases)as HighestInfectionRate, MAX((total_cases/population))*100 as PopulationInfected_Percentage
From PortofolioCovidProject..coviddeaths
GROUP BY population, location
ORDER BY PopulationInfected_Percentage DESC;


ALTER TABLE PortofolioCovidproject..coviddeaths
ALTER COLUMN total_deaths INT

--Countries with the highest Death Count per Population
--Continent
Select continent, MAX (total_deaths) TotalDeathsCounts
From PortofolioCovidProject..coviddeaths
WHERE continent IS NOT NULL
GROUP BY continent
ORDER BY TotalDeathsCounts DESC

--Location
Select location, MAX (total_deaths) TotalDeathsCounts
From PortofolioCovidProject..coviddeaths
WHERE continent IS NOT NULL
GROUP BY location
ORDER BY TotalDeathsCounts DESC


ALTER TABLE PortofolioCovidproject..coviddeaths
ALTER COLUMN new_deaths INT

ALTER TABLE PortofolioCovidproject..coviddeaths
ALTER COLUMN new_cases INT

--Global Numbers
SELECT date, SUM(new_cases) AS Total_cases, SUM(new_deaths) AS Total_deaths,
CASE
	WHEN SUM(new_cases) = 0 THEN 0
	ELSE SUM(new_deaths)*100.0/SUM(new_cases)
END AS Deaths_Percentage
From PortofolioCovidProject..coviddeaths
WHERE continent IS NOT NULL
GROUP BY date
ORDER BY 1, 2
